import.version:3.0.0 {unitt}! 
import {src/hamming}!

describe "Hamming" [
    it "empty strands" [
        expects.be:'equal? @[0 distance "" ""]
    ]

    it "single letter identical strands" [
        expects.be:'equal? @[0 distance "A" "A"]
    ]

    it "long identical strands" [
        expects.be:'equal? @[
            0
            distance "GGACTGAAATCTG" "GGACTGAAATCTG"
        ]
    ]

    it "single letter different strands" [
        expects.be:'equal? @[1 distance "G" "T"]
    ]

    it "long different strands" [
        expects.be:'equal? @[
            9
            distance "GGACGGATTCTG" "AGGACGGATTCT"
        ]
    ]

    it "disallow empty first strand" [
        expects.be:'null? @[distance "" "G"]
    ]

    it "disallow first strand longer" [
        expects.be:'null? @[distance "AATG" "AAA"]
    ]

    it "disallow second strand longer" [
        expects.be:'null? @[distance "ATA" "AGTG"]
    ]

    it "disallow empty second strand" [
        result: distance "G" ""
        expects.be:'null? @[distance "G" ""]
    ]
]
