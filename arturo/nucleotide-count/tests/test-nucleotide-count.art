import.version:3.0.0 {unitt}! 
import {src/nucleotide-count}!

describe "Nucleotide Count" [
    it "an empty strand does not increment the counts" [
        expects.be:'equal?  @[
            #[A: 0 C: 0 G: 0 T: 0]
            nucleotideCounts ""
        ]
    ]

    it "a strand with one nucleotide increments that nucleotide's count" [
        expects.be:'equal?  @[
            #[A: 0 C: 0 G: 1 T: 0]
            nucleotideCounts "G"
        ]
    ]

    it "a strand with a repeated nucleotide increments that nucleotide's count" [
        expects.be:'equal?  @[
            #[A: 0 C: 0 G: 7 T: 0]
            nucleotideCounts "GGGGGGG"
        ]
    ]

    it "a strand with multiple nucleotides increments the respective nucleotide counts" [
        strand: "AGCTTTTCATTCTGACTGCAACGGGCAATATGTCTCTGTGTGGATTAAAAAAAGAGTGTCTGATAGCAGC"
        expects.be:'equal?  @[
            #[A: 20 C: 12 G: 17 T: 21]
            nucleotideCounts strand
        ]
    ]

    it "a strand with invalid nucleotides returns null instead" [
        expects.be:'null? @[nucleotideCounts "AGXXACT"]
    ]
]
