import.version:3.0.0 {unitt}! 
import {src/protein-translation}!

describe "Protein Translation" [
    it "Empty RNA sequence results in no proteins" [
        expects.be:'equal? @[
            []
            toProteins ""
        ]
    ]

    it "Methionine RNA sequence" [
        expects.be:'equal? @[
            ["Methionine"]
            toProteins "AUG"
        ]
    ]

    it "Phenylalanine RNA sequence 1" [
        expects.be:'equal? @[
            ["Phenylalanine"]
            toProteins "UUU"
        ]
    ]

    it "Phenylalanine RNA sequence 2" [
        expects.be:'equal? @[
            ["Phenylalanine"]
            toProteins "UUC"
        ]
    ]

    it "Leucine RNA sequence 1" [
        expects.be:'equal? @[
            ["Leucine"]
            toProteins "UUA"
        ]
    ]

    it "Leucine RNA sequence 2" [
        expects.be:'equal? @[
            ["Leucine"]
            toProteins "UUG"
        ]
    ]

    it "Serine RNA sequence 1" [
        expects.be:'equal? @[
            ["Serine"]
            toProteins "UCU"
        ]
    ]

    it "Serine RNA sequence 2" [
        expects.be:'equal? @[
            ["Serine"]
            toProteins "UCC"
        ]
    ]

    it "Serine RNA sequence 3" [
        expects.be:'equal? @[
            ["Serine"]
            toProteins "UCA"
        ]
    ]

    it "Serine RNA sequence 4" [
        expects.be:'equal? @[
            ["Serine"]
            toProteins "UCG"
        ]
    ]

    it "Tyrosine RNA sequence 1" [
        expects.be:'equal? @[
            ["Tyrosine"]
            toProteins "UAU"
        ]
    ]

    it "Tyrosine RNA sequence 2" [
        expects.be:'equal? @[
            ["Tyrosine"]
            toProteins "UAC"
        ]
    ]

    it "Cysteine RNA sequence 1" [
        expects.be:'equal? @[
            ["Cysteine"]
            toProteins "UGU"
        ]
    ]

    it "Cysteine RNA sequence 2" [
        expects.be:'equal? @[
            ["Cysteine"]
            toProteins "UGC"
        ]
    ]

    it "Tryptophan RNA sequence" [
        expects.be:'equal? @[
            ["Tryptophan"]
            toProteins "UGG"
        ]
    ]

    it "STOP codon RNA sequence 1" [
        expects.be:'equal? @[
            []
            toProteins "UAA"

        ]
    ]

    it "STOP codon RNA sequence 2" [
        expects.be:'equal? @[
            []
            toProteins "UAG"
        ]
    ]

    it "STOP codon RNA sequence 3" [
        expects.be:'equal? @[
            []
            toProteins "UGA"
        ]
    ]

    it "Sequence of two protein codons translates into proteins" [
        expects.be:'equal? @[
            ["Phenylalanine" "Phenylalanine"]
            toProteins "UUUUUU"
        ]
    ]

    it "Sequence of two different protein codons translates into proteins" [
        expects.be:'equal? @[
            ["Leucine" "Leucine"]
            toProteins "UUAUUG"
        ]
    ]

    it "Translate RNA strand into correct protein list" [
        expects.be:'equal? @[
            ["Methionine" "Phenylalanine" "Tryptophan"]
            toProteins "AUGUUUUGG"
        ]
    ]

    it "Translation stops if STOP codon at beginning of sequence" [
        expects.be:'equal? @[
            []
            toProteins "UAGUGG"

        ]
    ]

    it "Translation stops if STOP codon at end of two-codon sequence" [
        expects.be:'equal? @[
            ["Tryptophan"]
            toProteins "UGGUAG"
        ]
    ]

    it "Translation stops if STOP codon at end of three-codon sequence" [
        expects.be:'equal? @[
            ["Methionine" "Phenylalanine"]
            toProteins "AUGUUUUAA"
        ]
    ]

    it "Translation stops if STOP codon in middle of three-codon sequence" [
        expects.be:'equal? @[
            ["Tryptophan"]
            toProteins "UGGUAGUGG"
        ]
    ]

    it "Translation stops if STOP codon in middle of six-codon sequence" [
        expects.be:'equal? @[
            ["Tryptophan" "Cysteine" "Tyrosine"]
            toProteins "UGGUGUUAUUAAUGGUUU"
        ]
    ]

    it "Sequence of two non-STOP codons does not translate to a STOP codon" [
        expects.be:'equal? @[
            ["Methionine" "Methionine"]
            toProteins "AUGAUG"
        ]
    ]

    it "Non-existing codon can't translate" [
        expects.be:'null? @[toProteins "AAA"]
    ]

    it "Unknown amino acids, not part of a codon, can't translate" [
        expects.be:'null? @[toProteins "XYZ"]
    ]

    it "Incomplete RNA sequence can't translate" [
        expects.be:'null? @[toProteins "AUGU"]
    ]

    it "Incomplete RNA sequence can translate if valid until a STOP codon" [
        expects.be:'equal? @[
            ["Phenylalanine" "Phenylalanine"]
            toProteins "UUCUUCUAAUGGU"
        ]
    ]
]
