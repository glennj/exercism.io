import.version:3.0.0 {unitt}! 
import {src/flatten-array}!

describe "Flatten Array" [
    it "empty" [
        expects.be:'equal? @[
            []
            flattenCollection []
        ]
    ]

    it "no nesting" [
        expects.be:'equal? @[
            [0 1 2]
            flattenCollection [0 1 2]
        ]
    ]

    it "flattens a nested array" [
        expects.be:'equal? @[
            []
            flattenCollection [[[]]]
        ]
    ]

    it "flattens array with just integers present" [
        expects.be:'equal? @[
            [1 2 3 4 5 6 7 8]
            flattenCollection [1 [2 3 4 5 6 7] 8]
        ]
    ]

    it "5 level nesting" [
        expects.be:'equal? @[
            [0 2 2 3 8 100 4 50 neg 2]
            flattenCollection [0 2 [[2 3] 8 100 4 [[[50]]]] neg 2]
        ]
    ]

    it "6 level nesting" [
        expects.be:'equal? @[
            [1 2 3 4 5 6 7 8]
            flattenCollection [1 [2 [[3]] [4 [[5]]] 6 7] 8]
        ]
    ]

    it "null values are omitted from the final result" [
        expects.be:'equal? @[
            [1 2]
            flattenCollection @[1 2 null]
        ]
    ]

    it "consecutive null values at the front of the array are omitted from the final result" [
        expects.be:'equal? @[
            [3]
            flattenCollection @[null null 3]
        ]
    ]

    it "consecutive null values in the middle of the array are omitted from the final result" [
        expects.be:'equal? @[
            [1 4]
            flattenCollection @[1 null null 4]
        ]
    ]

    it "6 level nested array with null values" [
        expects.be:'equal? @[
            [0 2 2 3 8 100 2]
            flattenCollection @[0 2 @[[2 3] 8 @[@[100]] null @[@[null]]] 2]
        ]
    ]

    it "all values in nested array are null" [
        expects.be:'equal? @[
            []
            flattenCollection @[null @[@[@[null]]] null null @[@[null null] null] null]
        ]
    ]
]
