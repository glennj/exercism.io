import.version:3.0.0 {unitt}! 
import {src/transpose}!

describe "Transpose" [
    it "empty string" [
        expects.be:'equal? @[
            ""
            transpose ""
        ]
    ]

    it "two characters in a row" [
        expected: join.with:"\n" [
            "A"
            "1"
        ]
        expects.be:'equal? @[
            expected
            transpose "A1"
        ]
    ]

    it "two characters in a column" [
        lines: join.with:"\n" [
            "A"
            "1"
        ]
        expects.be:'equal? @[
            "A1"
            transpose lines
        ]
    ]

    it "simple" [
        lines: join.with:"\n" [
            "ABC"
            "123"
        ]
        expected: join.with:"\n" [
            "A1"
            "B2"
            "C3"
        ]
        expects.be:'equal? @[
            expected
            transpose lines
        ]
    ]

    it "single line" [
        expected: join.with:"\n" [
            "S"
            "i"
            "n"
            "g"
            "l"
            "e"
            " "
            "l"
            "i"
            "n"
            "e"
            "."
        ]
        expects.be:'equal? @[
            expected
            transpose "Single line."
        ]
    ]

    it "first line longer than second line" [
        lines: join.with:"\n" [
            "The fourth line."
            "The fifth line."
        ]
        expected: join.with:"\n" [
            "TT"
            "hh"
            "ee"
            "  "
            "ff"
            "oi"
            "uf"
            "rt"
            "th"
            "h "
            " l"
            "li"
            "in"
            "ne"
            "e."
            "."
        ]
        expects.be:'equal? @[
            expected
            transpose lines
        ]
    ]

    it "second line longer than first line" [
        lines: join.with:"\n" [
            "The first line."
            "The second line."
        ]
        expected: join.with:"\n" [
            "TT"
            "hh"
            "ee"
            "  "
            "fs"
            "ie"
            "rc"
            "so"
            "tn"
            " d"
            "l "
            "il"
            "ni"
            "en"
            ".e"
            " ."
        ]
        expects.be:'equal? @[
            expected
            transpose lines
        ]
    ]

    it "mixed line length" [
        lines: join.with:"\n" [
            "The longest line."
            "A long line."
            "A longer line."
            "A line."
        ]
        expected: join.with:"\n" [
            "TAAA"
            "h   "
            "elll"
            " ooi"
            "lnnn"
            "ogge"
            "n e."
            "glr"
            "ei "
            "snl"
            "tei"
            " .n"
            "l e"
            "i ."
            "n"
            "e"
            "."
        ]
        expects.be:'equal? @[
            expected
            transpose lines
        ]
    ]

    it "square" [
        lines: join.with:"\n" [
            "HEART"
            "EMBER"
            "ABUSE"
            "RESIN"
            "TREND"
        ]
        expected: join.with:"\n" [
            "HEART"
            "EMBER"
            "ABUSE"
            "RESIN"
            "TREND"
        ]
        expects.be:'equal? @[
            expected
            transpose lines
        ]
    ]

    it "rectangle" [
        lines: join.with:"\n" [
            "FRACTURE"
            "OUTLINED"
            "BLOOMING"
            "SEPTETTE"
        ]
        expected: join.with:"\n" [
            "FOBS"
            "RULE"
            "ATOP"
            "CLOT"
            "TIME"
            "UNIT"
            "RENT"
            "EDGE"
        ]
        expects.be:'equal? @[
            expected
            transpose lines
        ]
    ]

    it "triangle" [
        lines: join.with:"\n" [
            "T"
            "EE"
            "AAA"
            "SSSS"
            "EEEEE"
            "RRRRRR"
        ]
        expected: join.with:"\n" [
            "TEASER"
            " EASER"
            "  ASER"
            "   SER"
            "    ER"
            "     R"
        ]
        expects.be:'equal? @[
            expected
            transpose lines
        ]
    ]

    it "jagged triangle" [
        lines: join.with:"\n" [
            "11"
            "2"
            "3333"
            "444"
            "555555"
            "66666"
        ]
        expected: join.with:"\n" [
            "123456"
            "1 3456"
            "  3456"
            "  3 56"
            "    56"
            "    5"
        ]
        expects.be:'equal? @[
            expected
            transpose lines
        ]
    ]
]
